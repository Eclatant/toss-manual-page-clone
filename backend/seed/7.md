### 에스크로 결제 진행

에스크로 결제는 아래와 같은 흐름으로 진행됩니다.

![에스크로 결제 흐름](http://tossdev.github.io/images/flow_escrow.png)

1. 에스크로 결제 생성 및 구매자의 승인 완료
2. 배송등록 대기 중 : 구매자가 결제 승인을 완료하여 구매 대금이 출금된 상태입니다. (구매 대금은 '구매 확정'될 때 까지 토스가 보관합니다) 판매자가 물품 배송을 완료한 후, '배송 등록'을 하면 '구매확정 대기 중' 상태로 변경됩니다.
3. 구매확정 대기 중 : 구매자의 '구매 확정'을 기다리는 상태입니다. 이 때 구매자는 '구매 확정' 또는 '지급 거부'할 수 있습니다.
   * 구매 확정 시 : 결제가 완료되고 판매자는 대금을 정산받습니다.
   * 지급 거부 시 : '구매자 지급 거부' 상태가 되며, 대금 정산이 진행되지 않습니다. 구매자와 판매자간 합의를 거친 후, '환불'하거나 '구매확정을 다시 요청'할 수 있습니다.

위와 같은 에스크로 결제 진행 과정에서 판매자가 반드시 조치해야하는 두 가지 상황이 있습니다.

1. '배송등록 대기 중' 상태에서 물품 배송 후 **'배송 등록'하기**
2. '구매자 지급 거부' 상태에 빠졌을 때 문제를 해결하고 **'구매확정 재요청'하기**

위 두 상황에서 조치를 취하지 않으면 결제 및 대금 지급이 이루어지지 않으므로 잊지말고 진행해야 합니다. '배송 등록'과 '구매확정 재요청' 처리 시 사용하는 API 가 지금부터 소개할 '에스크로 결제 진행 API'입니다.

아래 예제는 에스크로 결제 진행 API 의 예제 코드입니다.

```curl
curl "https://toss.im/tosspay/api/v1/escrow" \
-H "content-Type: application/json" \
-d '{
"payToken":"test_token1234567890a",                  # 결제 고유 번호
"apiKey":"sk_test_apikey1234567890a"     # 상점의 API Key
}'
```

'배송등록 대기 중' 상태인 결제 건에 대해 위 요청을 보내면 '배송 등록' 처리됩니다.

'구매자 지급 거부' 상태인 결제 건에 대해 위 요청을 보내면 '구매확정 재요청' 처리됩니다.

#### 에스크로 결제 진행 API 의 Endpoint

POST https://toss.im/tosspay/api/v1/escrow

#### 필수 Parameters

1. **상점 API Key** : 결제를 생성한 상점의 API key 가 필요합니다.
2. **결제 고유 토큰 (payToken)** : 결제 생성 완료 후 받은 결제 고유번호

#### 에스크로 결제 정책

에스크로 결제와 관련된 자세한 정책은 아래 문서를 참고하세요.

[토스 결제 서비스 정책 > 에스크로 결제](http://tossdev.github.io/policy.html#escrow)
