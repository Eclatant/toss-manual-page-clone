### 결제 상태 알아보기

결제가 생성되고 진행됨에 따라 결제의 '상태'는 끊임없이 바뀝니다. 상점 운영을 위해선 특정 결제건이 현재 어떤 상태인지 파악할 일이 많을 것입니다. 결제가 잘 끝난 것인지, 취소된 것은 아닌지. 환불 요청에 들어왔던 주문은 잘 환불 되었는지...

그럴땐 망설이지 말고 '결제 상태 확인 API'를 찾아주세요. 아래 예제는 결제 상태 확인 API 호출 코드입니다.

```curl
curl "https://toss.im/tosspay/api/v1/status" \
-H "content-Type: application/json" \
-d '{
"apiKey":"sk_test_apikey1234567890a",    # 상점의 API Key (필수)
"payToken":"test_token1234567890a",                  # 결제 고유 번호 (필수)
}'
```

#### 결제 상태 확인 API 의 Endpoint

POST https://toss.im/tosspay/api/v1/status

#### 필수 Parameters

필수 파라미터는 딱 2 가지 입니다. '어느 가맹점'에서 일어난 '어떤 결제건'을 조회하고 싶은지 알려주세요.

1. **상점 API Key** : 결제를 생성한 상점의 API key 가 필요합니다.
2. **결제 고유 토큰 (payToken)** : 결제 생성 완료 후 받은 결제 고유번호

\* '결제 고유 토큰 (payToken)' 대신 '상점의 주문번호 (orderNo)'값을 사용할 수도 있습니다.

#### 결제 상태 확인 요청에 대한 응답

결제 상태 확인 요청에 대한 응답은 아래와 같은 형태로 받게됩니다.

```json
{
  "code":0,                           # 응답코드
  "payToken":"test_token1234567890a"  # 결제 고유 번호
  "orderNo":"2015072012211",          # 상점의 주문번호
  "payStatus":"REFUND_SUCCESS",       # 결제 상태
  "availableActions ":["REFUND"],     # 가능한 액션 목록
  "hasOwner":true,                    # 결제할 사람의 정보 입력 여부
  "metadata":"metadata"               # 결제 생성 시 입력한 metadata
}
```

각 항목은 다음과 같은 의미를 가지고 있습니다.

* **응답코드** : 요청에 대한 결과. 성공하면 '0' 입니다.
* **결제 고유 번호** : 결제 생성 완료 후 받은 결제 고유번호. '주문번호'로 상태를 조회하면 이 값을 참조하여 '결제 고유번호 값을 알 수 있습니다.
* **상점의 주문번호** : 상점에서 사용하는 주문번호. 'payToken'으로 상태를 조회하면 이 값을 참조하여 '주문번호'를 알 수 있습니다.
* **결제 상태** : 조회 당시의 결제 상태 (아래 '결제 상태 목록'을 참고하세요)
* **가능한 액션 목록** : 조회 당시에 가능한 액션(취소, 환불 등) 목록 (예를 들어, '결제 완료' 상태에서는 '환불'이 가능하나 '전액 환불'한 상태에서는 환불 불가)
* **결제할 사람의 정보 입력 여부** : 당신의 상점에서 결제를 생성하고 결제 진행 웹페이지를 구매자에게 제공하고 나면 구매자는 결제 승인에 필요한 정보를 입력합니다. 결제를 진행할 사람에 대한 정보가 올바르게 입력되면 이 값은 true 가 됩니다. 반면, 아직 정보를 입력하지 않은 상태라면 false 입니다.
* **결제 연관 data** : 결제 생성 시 가맹점 측에서 해당 결제건과 연관된 정보를 metadata field 를 통헤 기록할 수 있고, 결제 상태 조회를 통해 기록하셨던 data 에 다시 접근하실 수 있습니다.

#### 결제 상태 목록

결제 상태는 아래 중 하나입니다.
각 상태에 대한 자세한 설명은 [결제 API > 결제 상태](http://tossdev.github.io/api.html#state) 문서를 참고하세요.

| PAY_STANDBY                | 결제 대기 중                     |
| -------------------------- | -------------------------------- |
| PAY_CANCEL                 | 결제 취소                        |
| PAY_PROGRESS               | 결제 진행 중                     |
| PAY_COMPLETE               | 결제 완료                        |
| ESCROW_REQUEST             | 배송등록 대기 중 (에스크로 요청) |
| ESCROW_RELEASE             | 구매확정 대기 중 (에스크로 해제) |
| ESCROW_DENY                | 구매자 지급 거부 (에스크로 거부) |
| REFUND_PROGRESS            | 환불 진행 중                     |
| REFUND_SUCCESS             | 환불 성공                        |
| SETTLEMENT_COMPLETE        | 정산 완료                        |
| SETTLEMENT_REFUND_COMPLETE | 환불 정산 완료                   |
